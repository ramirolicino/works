USE EMPRESA_TEST_DB;



INSERT INTO Producto(ID_PRODUCTO, NOMBRE, PRECIO)
VALUES
(20, 'COMPUTADORA', 250.00),
(21, 'TELEVISOR', 200.00),
(22, 'PARLANTE', 120.00),
(23, 'AURICULARES', 50.00),
(24, 'MOUSE/TECLADO', 15.00);


INSERT INTO Servicio(ID_SERVICIO, NOMBRE, PRECIO)
VALUES
(30, 'LUZ', 30.00),
(31, 'GAS', 20.00),
(32, 'AGUA', 15.00),
(33, 'TELEFONO', 50.00),
(34, 'INTERNET', 80.00);


INSERT INTO Cliente(NOMBRE, APELLIDO, DNI, ID_PRODUCTO, ID_SERVICIO, ADEUDA)
VALUES
('Jorge', 'Cripo', '41235224', 20, 32, 0),
('Ramon', 'Gonzales', '42235224', 24, 30, 1),
('Maria', 'Chana', '45653557', 22, 32, 1),
('Susana', 'Paiz', '41255667', 24, 31, 0),
('Ramiro', 'Olicino', '41235009', 21, 34, 0);


--DELETE FROM Cliente;
SELECT * FROM Producto;
SELECT * FROM Servicio;
SELECT * FROM Cliente;


--Ej8
SELECT c.ID_CLIENTE, c.APELLIDO, p.NOMBRE AS "PRODUCTO", s.NOMBRE AS "SERVICIO", SUM(p.PRECIO + s.PRECIO) AS "TOTAL A PAGAR", c.ADEUDA, CONVERT(varchar,GETDATE(),3) as [DD/MM/YY]
	FROM Cliente c
	INNER JOIN Producto p ON p.ID_PRODUCTO = c.ID_PRODUCTO 
	INNER JOIN Servicio s ON s.ID_SERVICIO = c.ID_SERVICIO
	WHERE c.ID_CLIENTE = 22
	GROUP BY c.ID_CLIENTE, c.APELLIDO, p.NOMBRE, s.NOMBRE, c.ADEUDA;


--Ej9
Select ID_CLIENTE,NOMBRE, APELLIDO, DNI, ADEUDA, CONVERT(varchar,GETDATE(),3) as [DD/MM/YY]
	FROM Cliente
	WHERE ADEUDA = 0;





